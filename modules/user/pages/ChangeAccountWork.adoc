=  Обновление данных учетной записи

[WARNING]
====
Перед обновление данных учетной записи, рекомендуется сделать резервную копию БД {dv}. Операция должна выполняться в нерабочее время.
====

. Запустите _Мастер обновления учетных записей_.
+
Будет открыто основное окно утилиты:

image::ChangeAccount_sp.png[Основное окно программы]

Кликните *Next* для перехода к следующей странице.
. Введите данные для подключения к базе данных {dv}:
* адрес SQL-сервера
* имя пользователя и пароль
* базу данных {dv}
+
image::ChangeAccount_p1.png[Подключение к базе данных {dv}]

[WARNING]
====
Пользователь, от имени которого выполняется подключение, должен обладать административными правами доступа к базе данных {dv}.
====
+
Кликните *Next* для перехода к следующей странице.
. Выполните оптимизацию базы данных {dv}.
+
На данном этапе из БД {dv} будут удалены неиспользуемые дескрипторы безопасности (связаны с удаленными объектами).
+
Рекомендуется выполнить процедуру удаления неиспользуемых дескрипторов, т.к. данные дескрипторы также обрабатываются в процессе работы программы, на что требуется дополнительное время. Утилита выполняет удаление дублирующихся дескрипторов с разными SDID, но одинаковыми дескрипторами. В этом случае выбирается один SDID, прочие заменяются на него и удаляются.
+
image::ChangeAccount_p2.png[Оптимизация базы данных {dv}]

Чтобы запустить оптимизацию, нажмите *Начать оптимизацию*. После завершения процедуры будет отображено окно с результатами:

image::ChangeAccount_p2_result.png[Результат оптимизации базы данных]

Кликните *Next* для перехода к следующей странице.
. Измените требуемые учетные записи.
+
image::ChangeAccount_p3_def.png[Список учетных записей, полученных из базы данных {dv}]
+
[WARNING]
====
В данном списке отображаются все имеющиеся в базе данных {dv} учетные записи, в том числе системные (например, LocalSystem). Не изменяйте и не удаляйте системные учетные записи.
====
[loweralpha]
.. Выберите в списке учетную запись, которую необходимо переименовать и нажмите *Редактировать*.
+
Будет открыто окно редактирования:

image::ChangeAccount_p3_edit.png[Редактирование записи сопоставления учетных записей]
.. Введите в поле *Новый пользователь* новое название учетной записи (с доменом) и нажмите *Принять*.
+
Вместо названия учетной записи можно указать идентификатор безопасности (SID) учетной записи. При этом следует установить флаг *SID*.

image::ChangeAccount_p3_SID.png[Редактирование записи сопоставления учетных записей с использованием SID]
+
Если SID (или учетная запись), указанный в поле `Старый пользователь`, отсутствует в базе данных {dv}, то при сохранении данной записи будет выдано предупреждение об отсутствии пользователя, запись сохранена не будет. Если учетная запись, указанная в поле `Новый пользователь`, не найдена в домене, то также будет выдано предупреждение, запись сохранена не будет.

[NOTE]
====
Если требуется удалить данные об учетной записи из базы данных {dv}, не изменяя данные установите флаг *Удалить*.
====
.. Повторите операцию для других учетных записей, которые нужно изменить.
+
Учетные записи, которые будут изменены (переименованы или удалены) в процессе применения изменений, будут выделены красным цветом.

image::ChangeAccount_p3.png[Список учетных записей после переименования]

Кликните *Next* для перехода к следующей странице. Если измененных учетных записей нет, то переход к следующему шагу будет заблокирован.
. Выберите данные, в которые необходимо внести изменения.
+
image::ChangeAccount_p4.png[Выбор обновляемых данных]
+
Утилита изменяет сведения об учетных записях сотрудников в _Справочнике сотрудников_ и в некоторых системных таблицах, а также обновляет права доступа к объектам (карточкам) {dv}. На данном шаге нужно выбрать в какие таблицы следует вносить изменения.

Не изменяйте состав обновляемых данных (по умолчанию выбраны все таблицы), если для этого нет причин.
+
Кликните *Next* для перехода к следующей странице.
. Запустите процесс обновления кликнув *Next*.
+
image::ChangeAccount_p5.png[Результаты обновления данных]
+
В процессе внесения изменений будет выводиться информация об обновляемых объектах и результатах обновления. До завершения обновления кнопка *Next* будет заблокирована.

В случае возникновения ошибки, дальнейшая обработка будет остановлена; вместо фразы "Успешно" будет указана причина ошибки.

Кликните *Next* для перехода к следующей странице.
. Завершите работу мастера.
+
image::ChangeAccount_finish.png[Завершение работы]
+
Кликните *Finish*, чтобы выйти из программы. Если нужно повторить процедуру переименования для других пользователей, вернитесь (кнопкой *Back*) к странице со списком учетных записей (п.4) и нажмите кнопку *Обновить*, чтобы увидеть ранее выполненные изменения; выполните шаги, начиная с п. 4.

Перезапустите сервер {dv} после завершения процедуры.
